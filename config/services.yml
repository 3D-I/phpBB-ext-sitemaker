imports:
    - { resource: parameters.yml }
    - { resource: blocks.yml }

services:

    primetime:
        class: primetime\primetime\core\primetime
        arguments:
            - @path_helper
            - @template
            - @user
            - @primetime.template

    primetime.icon_picker:
        class: primetime\primetime\core\icon_picker
        arguments:
            - @user
            - @primetime
            - @primetime.template

    primetime.blocks.admin:
        class: primetime\primetime\controller\blocks_admin
        arguments:
            - @auth
            - @request
            - @user
            - @primetime.blocks.manager

    primetime.blocks.display:
        class: primetime\primetime\core\blocks\display
        arguments:
            - @auth
            - @cache.driver
            - @dbal.conn
            - @request
            - @template
            - @user
            - @primetime
            - @primetime.template
            - %tables.primetime.blocks%
            - %tables.primetime.blocks_config%
            - %tables.primetime.block_routes%

    primetime.blocks.manager:
        class: primetime\primetime\core\blocks\manager
        arguments:
            - @cache.driver
            - @dbal.conn
            - @request
            - @template
            - @user
            - @primetime.icon_picker
            - @primetime
            - @primetime.template
            - %tables.primetime.blocks%
            - %tables.primetime.blocks_config%
            - %tables.primetime.block_routes%

    primetime.block_collection:
        class: phpbb\di\service_collection
        arguments:
            - @service_container
        tags:
            - { name: service_collection, tag: primetime.block }

    primetime.blocks.factory:
        class: primetime\primetime\core\blocks\factory
        arguments:
            - @primetime.block_collection

    primetime.forum:
        class: primetime\primetime\core\forum\query
        arguments:
            - @config
            - @dbal.conn
            - @user
            - @primetime

    primetime.listener:
        class: primetime\primetime\event\listener
        arguments:
            - @request
            - @primetime
            - @primetime.blocks.display
        tags:
            - { name: event.listener }

    primetime.members:
        class: primetime\primetime\core\members
        arguments:
            - @dbal.conn
            - @user
            - @primetime.template
            - %core.root_path%
            - %core.php_ext%

    primetime.menu.admin:
        class: primetime\primetime\controller\menu_admin
        arguments:
            - @request
            - @user
            - @template
            - @primetime.menu.builder
            - %tables.primetime.menu%

    primetime.menu.builder:
        class: primetime\primetime\core\menu\builder
        arguments:
            - @dbal.conn
            - @primetime
            - %tables.primetime.menu%
            - %tables.primetime.menu_items%
            - 'item_id'

    primetime.menu.display:
        class: primetime\primetime\core\menu\display
        arguments:
            - @dbal.conn
            - @primetime
            - %tables.primetime.menu_items%
            - 'item_id'

    primetime.template_context:
        class: phpbb\template\context

    primetime.template:
        class: primetime\primetime\core\template
        arguments:
            - @path_helper
            - @config
            - @user
            - @primetime.template_context
            - @ext.manager
